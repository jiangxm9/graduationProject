# API说明文档
 
## 登录注册模块
### 饭店注册
```
POST /res_register.php
```

输入参数：

```
username: 用户名(应为字母开头，不含大写字母，4-20字节)
password: 用户名对应密码(应为8-20字节，仅含大小写字母、数字、下划线(_)，明文即可)
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": {
        "token": "xxxxxxxxxxxxxxxxxxxxxxxxxx" //返回Token，仅在status为200时包含此字段
    }
}
```

输出状态码一览：

```
200: 注册成功，并返回Token
400: 请求方式或传参错误
403: 用户名已存在
404: 服务器链接错误，请稍后再试
1001: 用户名长度过短
1002: 密码长度过短
1003: 用户名长度过长
1004: 密码长度过长
1005: 用户名格式非法
1006: 密码格式非法
```

其它说明：

```
返回的Token应当在后续请求中加入到HTTP请求头部的Authorization字段中。
```

### 饭店登录
```
POST /res_login.php
```

输入参数:  

```
username: 用户名
password: 用户名对应密码(明文即可)
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": {
        "token": "xxxxxxxxxxxxxxxxxxxxxxxxxx" //返回Token，仅在status为200时包含此字段
    }
}
```

输出状态码一览：

```
200: 正常，并返回Token
400: 请求方式或传参错误
403: 用户名或密码错误
```

其它说明：

```
返回的Token应当在后续请求中加入到HTTP请求头部的Authorization字段中。
```

### 员工注册
```
POST /emp_register.php
```

输入参数：

```
username: 用户名(应为字母开头，不含大写字母，4-20字节)
password: 用户名对应密码(应为8-20字节，仅含大小写字母、数字、下划线(_)，明文即可)
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": {
        "id": "123" //返回员工id
    }
}
```

输出状态码一览：

```
200: 注册成功，并返回Token
400: 请求方式或传参错误
403: 用户名已存在
404: 服务器链接错误，请稍后再试
1001: 用户名长度过短
1002: 密码长度过短
1003: 用户名长度过长
1004: 密码长度过长
1005: 用户名格式非法
1006: 密码格式非法
```

其它说明：

```
返回的Token应当在后续请求中加入到HTTP请求头部的Authorization字段中。
```

### 员工登录

```
POST /emp_login.php
```

输入参数:  

```
username: 用户名
password: 用户名对应密码(明文即可)
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": {
        "token": "xxxxxxxxxxxxxxxxxxxxxxxxxx", //返回Token，仅在status为200时包含此字段
        "id": 123 //员工id
    }
}
```

输出状态码一览：

```
200: 正常，并返回Token
400: 请求方式或传参错误
403: 用户名或密码错误
```

其它说明：

```
返回的Token应当在后续请求中加入到HTTP请求头部的Authorization字段中。
```

## 店铺信息模块
### 上传店铺图片
```
POST /store/icon.php
```

输入参数：

```
图片文件，仅支持JPG与PNG格式，设置Content-Type为image/png或image/jpeg。
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": {
        "url": "http://example.com/xxx/xxxx.jpg" //服务器保存的图片路径（服务器保存图片，生成地址，并将其与当前登录用户绑定）
    }
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 获取饭店信息
```
GET /store/info.php
```

输入参数：

```
identity: 身份类型(店员(0)或者店主(1))
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": {
    	"name": "restaurant", //商家名称
    	"icon": "http://example.com/xxx/xxx.jpg" //商家头像
    }
}
```

输出状态码:

```
200: OK
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 更改饭店名称

```
POST /store/info.php
```

输入参数：

```
name: 商家昵称
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

## 菜单模块
### 获取商品列表
```
GET /store/food_list.php
```

输入参数：

```
identity: 身份类型(店员(0)或者店主(1))
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": [
        {
            "id": 123, //商品编号
            "name": "小炒肉", //商品名称
            "price": 20, //商品价格
            "icon": "http://example.com/xxx/xxxx.jpg" //商品图片
        },
        ...
    ]
}
```

输出状态码:

```
200: OK
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 上传商品图片

```
POST /store/food_icon.php
```

输入参数：

```
图片文件，仅支持JPG与PNG格式，设置Content-Type为image/png或image/jpeg。
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": {
        "url": "http://example.com/xxx/xxxx.jpg" //服务器保存的图片路径（服务器仅保存图片并生成地址，不会与对应商品进行绑定，需在“添加商品”时将此链接一并上传）
    }
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 添加商品
```
PUT /store/food.php
```

输入参数:

```
foodname: 商品名称
price: 商品价格
imgurl: 商品图标对应的服务器保存的图片路径
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
    "data": {
        "id": 123 //添加商品对应的编号
    }
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 修改商品
```
POST /store/food.php
```

输入参数:

```
foodid: 商品id(从数据库中选中需要修改的商品)
foodname: 商品新的名称
price: 商品新的价格
imgurl: 商品新的图标对应的服务器保存的图片路径
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 删除商品
```
DELETE /store/food.php
```

输入参数:

```
foodid: 商品编号
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

## 订单模块
### 获取订单列表（打开页面时调用）
```
GET /store/order_list.php
```

输入参数:

```
identity: 身份类型(店员(0)或者店主(1))
count: 按时间倒序获取的订单数量
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": [
        {
            "id": 123123123, //订单编号
            "time": "2019-01-01 00:00:00", //下单时间
            "status": false //订单状态，false为未完成，true为已完成
        },
        ...
    ]
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 获取订单详细信息
```
GET /store/order.php
```

输入参数:

```
identity: 身份类型(店员(0)或者店主(1))
id: 订单编号
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": {
        "id": 123123123, //订单ID
        "status": false, //订单状态，false为未完成，true为已完成
        "content": [ //订单内容
            {
                "id": 123456, //商品ID
                "name": "香辣小龙虾", //商品名
                "icon": "https://example.com/xxx/xxx.jpg", //商品图标
                "price": 120, //单价
                "number": 1 //数量
            },
            ...
        ]
    }
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 设置订单状态
```
POST /store/order.php
```

输入参数:

```
identity: 身份类型(店员(0)或者店主(1))
id: 订单编号
status: 要设置的订单状态，0为未完成，1为已完成
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 提交订单
```
PUT /store/order.php
```

输入参数:

```
identity: 身份类型(店员(0)或者店主(1))
order: 订单内容(JSON格式)
```

订单内容格式: 

```
{
    "content": [ //订单内容
        {
            "id": 123456, //商品ID
            "number": 1 //数量
        },
        ...
    ],
    "remark": "多放辣" //商品备注
}
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": {
    	"order_id": "1", //订单ID
    	"time": "2019-01-01 01:00:00" //下单时间
    }
}
```

输出状态码:

```
200: OK
400: 输入参数错误
```

## 店员管理模块
### 获取店员列表
```
GET /store/employee_list.php
```

输入参数：

```
identity: 身份类型(店员(0)或者店主(1))
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": [
        {
            "id": 123, //员工id
            "name": "小明", //员工姓名
            "job": 厨师, //员工岗位
            "wage": 8000 //员工工资
        },
        ...
    ]
}
```

输出状态码:

```
200: OK
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```
### 增加店员
```
PUT /store/employee.php
```

输入参数:

```
employeeid: 员工id
employeename: 员工姓名
employeejob: 员工职位
employeewage: 员工薪资
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 修改店员信息(岗位、薪资、姓名)
```
POST /store/employee.php
```

输入参数:

```
employeeid: 员工id
employeename: 员工姓名
employeejob: 员工职位
employeewage: 员工薪资
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 删除店员
```
DELETE /store/employee.php
```

输入参数

```
employeeid: 员工编号
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

## 任务管理模块
### 根据饭店id获取任务列表
```
GET /store/task.php
```

输入参数：

```
无
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": [
        {
            "id": 123, //任务编号
            "employeename": "小明", //员工姓名
            "employeejob": "厨师", //员工岗位
            "task": "扫地", //员工任务
            "evaluation": 4, //任务评价(五星制)
            "remark": "未打扫角落" //任务备注
            "tasktime": "2020-01-01 00:00:00", //任务开始时间
        },
        ...
    ]
}
```

输出状态码:

```
200: OK
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 根据员工id获取任务列表
```
GET /store/task_list.php
```

输入参数：

```
identity: 身份类型(店员(0)或者店主(1))
employeeid: 员工id(对于店主)/无(对于员工)
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK", //状态码描述
    "data": [
        {
            "id": 123, //任务编号
            "employeename": "小明", //员工姓名
            "employeejob": "厨师", //员工岗位
            "task": "扫地", //员工任务
            "evaluation": 4, //任务评价(五星制)
            "remark": "未打扫角落" //任务备注
            "tasktime": "2020-01-01 00:00:00", //任务开始时间
        },
        ...
    ]
}
```

输出状态码:

```
200: OK
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 增加任务
```
PUT /store/task.php
```

输入参数:

```
employeeid: 任务分配的员工id
task: 具体任务
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
    "data": {
    	"task_id": "1", //任务ID
    	"time": "2020-01-01 01:00:00" //下达时间
    }
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 修改/评价任务
```
POST /store/task.php
```

输入参数:

```
taskid: 任务id
task: 具体任务
evaluation: 任务评价(五星制)
remark: 任务备注
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 删除任务
```
DELETE /store/task.php
```

输入参数:

```
taskid: 任务id
```

输出(JSON格式):

```
{
    "status": 200, //返回状态码
    "msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```


